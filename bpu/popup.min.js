(function(d){var m=0,k=0,n=top!=self?top:self,e=navigator.userAgent.toLowerCase(),p=/webkit/.test(e);/mozilla/.test(e)&&/(compatible|webkit)/.test(e);var g=/chrome/.test(e),q=/msie|trident\//.test(e)&&!/opera/.test(e),r=/firefox/.test(e);/safari/.test(e)&&/chrome/.test(e);/opera/.test(e);var l=parseInt(e.match(/(?:[^\s]+(?:ri|ox|me|ra)\/|trident\/.*?rv:)([\d]+)/i)[1],10),f={simulateClick:function(a){a=this.createElement("a",{href:a||"data:text/html,<script>window.close();\x3c/script>;"});var b=document.createEvent("MouseEvents"); document.body.appendChild(a);b.initMouseEvent("click",!0,!0,d,0,0,0,0,0,!0,!1,!1,!0,0,null);a.dispatchEvent(b);a.parentNode.removeChild(a)},blur:function(a){try{a.blur(),a.opener.window.focus(),d.self.window.focus(),d.focus(),r?this.openCloseWindow(a):p?(!g||g&&41>l)&&this.openCloseTab():q&&setTimeout(function(){a.blur();a.opener.window.focus();d.self.window.focus();d.focus()},1E3)}catch(b){}},createElement:function(a,b,c){a=document.createElement(a);for(var d in b)a.setAttribute(d,b[d]);c&&(a.innerHTML= innerHTML);return a},openCloseWindow:function(a){var b=a.window.open("about:blank");b.focus();b.close();setTimeout(function(){try{b=a.window.open("about:blank"),b.focus(),b.close()}catch(c){}},1)},openCloseTab:function(){this.simulateClick()},isFlashInstalled:function(){return!!navigator.mimeTypes["application/x-shockwave-flash"]},removeFlashPopunder:function(a){setTimeout(function(){var b=document.getElementById(a.name+"_flash");b&&b.parentNode.removeChild(b)},1E3)},initFlashPopunder:function(a){if(this.isFlashInstalled){var b= this,c=a.name+"_flash",d,f,e=this.createElement("object",{type:"application/x-shockwave-flash",data:h.flashUrl,name:c,id:c,style:"position:fixed;visibility:visible;left:0;top:0;width:1px;height:1px;z-index:9999999;"});a=[{name:"flashvars",value:"fire="+a.name+".fire&name="+a.name},{name:"wmode",value:"transparent"},{name:"menu",value:"false"},{name:"allowscriptaccess",value:"always"}];for(f in a)e.appendChild(this.createElement("param",a[f]));d=setInterval(function(){"complete"==document.readyState&& (clearInterval(d),document.body.insertBefore(e,document.body.firstChild),e.focus(),b.attachEvent("mousedown",function(a){0===a.button&&(document.getElementById(c).style.width=document.getElementById(c).style.height="100%")}))},10);return e}},detachEvent:function(a,b,c){c=c||d;return c.removeEventListener?c.removeEventListener(a,b):c.detachEvent("on"+a,b)},attachEvent:function(a,b,c){c=c||d;return c.addEventListener?c.addEventListener(a,b):c.attachEvent("on"+a,b)},mergeObject:function(){var a={},b, c;for(b=0;b<arguments.length;b++)for(c in arguments[b])a[c]=arguments[b][c];return a},getCookie:function(a){return(a=document.cookie.match(new RegExp(a+"=[^;]+","i")))?decodeURIComponent(a[0].split("=")[1]):null},setCookie:function(a,b,c,d){if(null===c||"undefined"==typeof c)c="";else{var e;"number"==typeof c?(e=new Date,e.setTime(e.getTime()+6E4*c)):e=c;c="; expires="+e.toUTCString()}document.cookie=a+"="+escape(b)+c+"; path="+(d||"/")}},h=function(a,b){this.__construct(a,b)};h.flashUrl="flash/flash.swf"; h.prototype={defaultWindowOptions:{width:d.screen.width,height:d.screen.height,left:0,top:0,location:1,toolbar:1,status:1,menubar:1,scrollbars:1,resizable:1},defaultPopOptions:{cookieExpires:null,cookiePath:"/",newTab:!0,blur:!0,chromeDelay:500,beforeOpen:function(){},afterOpen:function(){}},__newWindowOptionsFlash:{menubar:0,toolbar:0},__newWindowOptionsChromeBefore41:{scrollbars:1},__construct:function(a,b){this.url=a;this.index=m++;this.name="SmartPopunder_"+this.index;this.executed=!1;this.setOptions(b); this.register();d[this.name]=this},register:function(){if(!this.isExecuted()){this.options.blur&&!this.options.newTab&&f.initFlashPopunder(this);var a=this,b=function(){a.shouldExecute()&&(a.fire(),f.detachEvent("click",b,d),f.detachEvent("click",b,document))};f.attachEvent("click",b,d);f.attachEvent("click",b,document)}},fire:function(a){a=d[a]||this;var b;a.options.beforeOpen.call(void 0,this);k=(new Date).getTime();a.setExecuted();a.options.newTab?g&&30<l&&a.options.blur?(d.open("javascript:window.focus()", "_self",""),f.simulateClick(a.url),b=null):b=n.window.open(a.url,"_blank"):b=d.open(a.url,a.url,a.getParams());a.options.afterOpen.call(void 0,this);a.options.blur&&f.blur(b);f.removeFlashPopunder(a)},shouldExecute:function(){return g&&k&&k+this.options.chromeDelay>(new Date).getTime()?!1:!this.isExecuted()},isExecuted:function(){return this.executed||!!f.getCookie(this.name)},setExecuted:function(){this.executed=!0;f.setCookie(this.name,1,this.options.cookieExpires,this.options.cookiePath)},setOptions:function(a){this.options= f.mergeObject(this.defaultWindowOptions,this.defaultPopOptions,a||{});if(!this.options.newTab){if(g&&41>l)for(var b in this.__newWindowOptionsChromeBefore41)this.options[b]=this.__newWindowOptionsChromeBefore41[b];if(f.isFlashInstalled())for(b in this.__newWindowOptionsFlash)this.options[b]=this.__newWindowOptionsFlash[b]}},getParams:function(){var a="",b;for(b in this.options)"undefined"!=typeof this.defaultWindowOptions[b]&&(a+=(a?",":"")+b+"="+this.options[b]);return a}};h.make=function(a,b){return new this(a, b)};d.SmartPopunder=h})(this);
